<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sliding Window Behavior Model</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <div class="container">
      <!-- <div class="container"> -->
      <div class="section">
        <h1 class="title">Sliding Window Behavior Model</h1>
        <!-- Visualization -->
        <div class="visualization">
          <div class="timeline-container">
            <div class="timeline-numbers" id="timelineNumbers">
              <!-- Numbers will be generated by JavaScript -->
            </div>

            <div class="timeline-track" id="timelineTrack">
              <!-- Window regions will be positioned here -->
              <div id="windowRegions"></div>

              <!-- Position markers -->
              <div id="positionMarkers"></div>
            </div>

            <!-- <div class="compensation-indicators" id="compensationIndicators"> -->
            <!-- Compensation zones will be shown here -->
          </div>
          <!-- </div> -->

          <div class="timeline-legend">
            <div class="legend-item-new">
              <div class="legend-line ic-marker"></div>
              <span>Viewport Center</span>
            </div>
            <div class="legend-item-new">
              <div
                class="legend-line"
                style="background: #d97706; border: 2px dashed #b45309"></div>
              <span>Constrained Center</span>
            </div>
            <div class="legend-item-new">
              <div class="legend-marker window-lower-compensation"></div>
              <span>Lower Window Region</span>
            </div>
            <div class="legend-item-new">
              <div class="legend-marker window-upper-compensation"></div>
              <span>Upper Window Region</span>
            </div>
            <div class="legend-item-new">
              <div class="legend-line limit-marker"></div>
              <span>Limits</span>
            </div>
            <div class="legend-item-new">
              <div class="legend-line window-boundary"></div>
              <span>Window Boundaries</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Controls -->
      <div class="section">
        <div class="controls-grid">
          <div class="control-group">
            <label class="control-label">Viewport Center (IC_Viewport)</label>
            <input
              type="range"
              id="icViewportSlider"
              class="slider"
              min="0"
              max="321"
              value="123" />
            <div class="control-value" id="icViewportValue">-</div>
          </div>

          <div class="control-group">
            <label class="control-label">Window Length (WinN)</label>
            <input
              type="range"
              id="winNSlider"
              class="slider"
              min="0"
              max="60"
              step="2"
              value="40" />
            <div class="control-value" id="winNValue">-</div>
          </div>

          <div class="control-group">
            <label class="control-label">Lower Limit (LimL)</label>
            <input
              type="range"
              id="limLSlider"
              class="slider"
              min="1"
              max="321"
              value="99" />
            <div class="control-value" id="limLValue">-</div>
          </div>

          <div class="control-group">
            <label class="control-label">Upper Limit (LimU)</label>
            <input
              type="range"
              id="limUSlider"
              class="slider"
              min="1"
              max="321"
              value="148" />
            <div class="control-value" id="limUValue">-</div>
          </div>

          <div class="control-group">
            <label class="control-label">Total Images (IT)</label>
            <input
              type="range"
              id="itSlider"
              class="slider"
              min="1"
              max="500"
              value="321" />
            <div class="control-value" id="itValue">-</div>
          </div>
        </div>
      </div>

      <!-- Status -->
      <div class="section">
        <div class="status-grid">
          <div class="status-item">
            <div class="status-label">Viewport Center</div>
            <div class="status-value" id="icViewportStatus">-</div>
            <div class="status-sub">Free-moving (IC_Viewport)</div>
          </div>
          <div class="status-item">
            <div class="status-label">Constrained Center</div>
            <div class="status-value" id="icConstrainedStatus">-</div>
            <div class="status-sub">Limited by bounds (IC)</div>
          </div>
          <div class="status-item">
            <div class="status-label">Window Upper (WinU)</div>
            <div class="status-value" id="winUStatus">-</div>
            <div class="warning" id="winUWarning" style="display: none">
              Exceeds upper limit!
            </div>
          </div>
          <div class="status-item">
            <div class="status-label">Window Lower (WinL)</div>
            <div class="status-value" id="winLStatus">-</div>
            <div class="warning" id="winLWarning" style="display: none">
              Below lower limit!
            </div>
          </div>
          <div class="status-item">
            <div class="status-label">Window Lengths</div>
            <div class="status-value" id="actualLength">-</div>
            <div class="status-sub">
              Requested: <span id="requestedLength">-</span>
            </div>
            <div class="status-sub">
              Effective: <span id="effectiveLength">-</span>
            </div>
            <div
              class="compensated"
              id="compensatedIndicator"
              style="display: none">
              Compensated!
            </div>
          </div>
          <div class="status-item">
            <div class="status-label">Window Behavior</div>
            <div class="status-sub" id="behaviorStatus">Centered normally</div>
          </div>
          <div class="status-item">
            <div class="status-label">Configuration Status</div>
            <div class="status-value valid" id="configStatus">Valid</div>
          </div>
          <div class="status-item">
            <div class="status-label">Total Images (IT)</div>
            <div class="status-value" id="totalImages">-</div>
          </div>
        </div>
      </div>

      <!-- Constraint Issues -->
      <div
        class="section error-section"
        id="errorSection"
        style="display: none">
        <div class="error-title">⚠️ Constraint Overlaps Detected:</div>
        <ul class="error-list" id="errorList"></ul>
      </div>

      <!-- Constraints Display -->
      <details class="section constraints-section">
        <summary class="section-title">Constraints & Behavior</summary>
        <div class="mono">
          Basic: 0 ≤ LimL ≤ IC ≤ LimU ≤ IT, WinU - WinL = EffectiveWinN
        </div>
        <div class="mono" id="currentConstraints">
          Current: 0 ≤ 0 ≤ 10 ≤ 20 ≤ 25, 13 - 7 = 6 (effective: 6)
        </div>
        <div class="behavior-list">
          <div class="behavior-item">
            <strong>Viewport Center:</strong>
            <span id="viewportCenterText"
              >IC_Viewport = 10 (free-moving from 0 to 25)</span
            >
          </div>
          <div class="behavior-item">
            <strong>Constrained Center:</strong>
            <span id="icConstraintText"
              >IC = 10 (constrained by limits: 0 ≤ IC ≤ 20)</span
            >
          </div>
          <div class="behavior-item">
            <strong>Window Calculation:</strong> Window positioned based on
            IC_Viewport, not constrained IC
          </div>
          <div class="behavior-item">
            <strong>Window Length Compensation:</strong>
            <span id="lengthCompensationText"
              >Requested 6 → Effective 6 (limited by space: 20)</span
            >
          </div>
          <div class="behavior-item">
            <strong>Position Compensation:</strong> When viewport center hits
            limits, opposite side extends to preserve effective length
          </div>
          <div class="behavior-item">
            <strong>Limit Interaction:</strong> Limits adjust each other -
            moving LimL above LimU pushes LimU up, moving LimU below LimL pulls
            LimL down
          </div>
        </div>
        <div class="notes">
          <div class="notes-item">
            • IC_Viewport represents the desired center from an external
            viewport (unconstrained)
          </div>
          <div class="notes-item">
            • IC shows where the system thinks the center should be given
            operational limits
          </div>
          <div class="notes-item">
            • Window positioning uses IC_Viewport but may compensate beyond
            limits to maintain length
          </div>
          <div class="notes-item">
            • Orange "Compensated!" indicator shows when effective length
            differs from requested length
          </div>
          <div class="notes-item">
            • Limits automatically adjust each other to prevent inverted
            configurations
          </div>
        </div>
      </details>
    </div>
  </body>
  <script src="index.js"></script>
</html>
